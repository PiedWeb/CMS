{% set gallery_id = random(10, 1000) %}

{% block gallery %}
    {% if page.images is defined and page.images is not empty %}
        <ul class="grid grid-cols-2 gap-3 list-none">
            {% for image in page.images.slice(galleryFilterFrom|default('0'), length|default('1000')) %}
                <li>{{ _self.galleryPart(image, gallery_id, page) }}</li>
            {% endfor %}
        </ul>
    {% endif %}
{% endblock %}


{% macro galleryPart(image, gallery_id, page = null, default_filter = 'thumb') %}
    {{ link(''
        ~'<picture>'
            ~'<source type="image/webp"'
                ~' srcset="'
                    ~ image.fullPathWebP|imagine_filter(default_filter) ~' 576w'
                ~'"'
                ~' />'
            ~'<img'
                ~' srcset="'
                    ~ image.fullPath|imagine_filter(default_filter) ~' 576w'
                ~'"'
                ~' src="'~ image.fullPath|imagine_filter('default') ~'" loading="lazy"'

                ~' width="10000" height="10000"'
                ~' alt="' ~ image.name(page is defined ? page.locale : null) ~'"'
                ~' />'
        ~'</picture>',
    image.fullPath|imagine_filter('default'),
    {'data-fslightbox': gallery_id, 'dwl': image.fullPathWebP|imagine_filter('default')}) }}
{% endmacro %}