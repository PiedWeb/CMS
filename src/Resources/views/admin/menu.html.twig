{% extends '@SonataAdmin/Menu/sonata_menu.html.twig' %}

{% block item %}
    {%- if item.displayed -%}
        {#- check role of the group #}
        {%- set display = item.extra('roles') is empty or is_granted(sonata_config.getOption('role_super_admin')) or item.extra('roles')|filter(role => is_granted(role))|length > 0 -%}
    {%- endif -%}

    {% if item.label in ['admin.label.theme', 'admin.label.params']
        and app.request.attributes.get('_route') in ['piedweb_cms_template_editor_create', 'piedweb_cms_template_editor_edit'] %}
        {% do item.setAttribute('class', (item.getAttribute('class') ~ ' active')) %}
    {% endif %}


    {%- if (item.displayed and display|default) -%}
        {%- set options = options|merge({branch_class: 'treeview', currentClass: "active", ancestorClass: "active"}) -%}
        {%- do item.setChildrenAttribute('class', (item.childrenAttribute('class')~' active')|trim) -%}
        {%- do item.setChildrenAttribute('class', (item.childrenAttribute('class')~' treeview-menu')|trim) -%}
        {{ parent() }}
    {%- endif -%}

{% endblock %}